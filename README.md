# api_terminology_service
Проект «Сервис терминологии».
Сервис позволяет с помощью GUI административной панели добавлять справочники, заводить несколько версий одного справочника, указывать дату начала действия версии и наполнять справочники элементами.
Также разработан API, позволяющий получать и валидировать данные справочников и его элементов.

# Технологии
- Python 3.8
- Django 3.2
- Django Rest Framework 3.12

# Установка
1. Клонируйте репозиторий с проектом
```sh
git clone https://github.com/ne4istii/api_terminology_service.git
```
2. Разверните в репозитории виртуальное окружение и активируйте его
```sh
python3 -m venv venv
source venv/bin/activate
```
3. Установите зависимости
```sh
pip install -r requirements.txt
```
4. В корне проекта создать файл .env и заполнить переменные окружения
```sh
touch .env
echo SECRET_KEY=<your_django_secret_key_from_settings.py> >> .env
```
5. Примените миграции
```sh
./manage.py makemigrations directories
./manage.py migrate
```
6. Загрузите дамп базы с тестовыми данными
```sh
./manage.py loaddata db_dump.json
```

# Примеры запросов

## Получение списка справочников
### запрос
`
curl --location --request GET 'http://127.0.0.1:8000/api/v1/directories/'
`
### ответ
```json
{
    "count": 11,
    "next": "http://127.0.0.1:8000/api/v1/directories/?page=2",
    "previous": null,
    "results": [
        {
            "uid": "1.2.643.5.1.13.13.99.2.863",
            "name": "ВМП. Справочник соответствия форм оплаты и источников оплаты",
            "title": "ВМП. Справочник соответствия форм оплаты и источников оплаты",
            "current_version": {
                "name": "1.1",
                "pub_date": "2021-09-22 09:35:00"
            },
            "creation_date": "2021-09-22 06:35:00"
        },
        {
            "uid": "1.2.643.5.1.13.13.99.2.860",
            "name": "Операторы персональных данных",
            "title": "Операторы персональных данных",
            "current_version": {
                "name": "1.1",
                "pub_date": "2021-09-15 13:05:00"
            },
            "creation_date": "2021-09-15 10:05:00"
        },
        {
            "uid": "1.2.643.5.1.13.13.99.2.747",
            "name": "РВ. Вакцины от коронавирусной инфекции (англоязычный)",
            "title": "РВ. Вакцины от коронавирусной инфекции (англоязычный)",
            "current_version": {
                "name": "1.6",
                "pub_date": "2021-09-21 11:16:00"
            },
            "creation_date": "2021-03-30 07:40:00"
        },
        {
            "uid": "1.2.643.5.1.13.13.99.2.725",
            "name": "Перечень заключений в медицинских документах",
            "title": "Перечень заключений в медицинских документах",
            "current_version": {
                "name": "1.9",
                "pub_date": "2021-09-13 17:06:00"
            },
            "creation_date": "2021-05-18 13:35:00"
        },
        {
            "uid": "1.2.643.5.1.13.13.99.2.611",
            "name": "Узлы СМНН. ЕСКЛП",
            "title": "Узлы СМНН. ЕСКЛП",
            "current_version": {
                "name": "4.21",
                "pub_date": "2021-09-22 14:46:00"
            },
            "creation_date": "2021-08-19 09:31:00"
        },
        {
            "uid": "1.2.643.5.1.13.13.99.2.308",
            "name": "Реестр ПВП (ФОМС)",
            "title": "Реестр ПВП (ФОМС)",
            "current_version": {
                "name": "2.305",
                "pub_date": "2021-09-23 20:00:00"
            },
            "creation_date": "2021-08-27 17:00:00"
        },
        {
            "uid": "1.2.643.5.1.13.13.99.2.166",
            "name": "Справочник кодируемых полей",
            "title": "Справочник кодируемых полей",
            "current_version": {
                "name": "1.66",
                "pub_date": "2021-09-22 12:25:00"
            },
            "creation_date": "2021-09-22 09:25:00"
        },
        {
            "uid": "1.2.643.5.1.13.13.99.2.114",
            "name": "ФРМО. Справочник структурных подразделений",
            "title": "ФРМО. Справочник структурных подразделений",
            "current_version": {
                "name": "2.869",
                "pub_date": "2021-09-24 02:41:00"
            },
            "creation_date": "2021-09-23 23:41:00"
        },
        {
            "uid": "1.2.643.5.1.13.13.11.1554",
            "name": "Этапы талона на оказание ВМП",
            "title": "Этапы талона на оказание ВМП",
            "current_version": {
                "name": "1.1",
                "pub_date": "2021-09-17 15:52:00"
            },
            "creation_date": "2021-09-17 12:52:00"
        },
        {
            "uid": "1.2.643.5.1.13.13.11.1522",
            "name": "Виды медицинской документации",
            "title": "Виды медицинской документации",
            "current_version": {
                "name": "4.38",
                "pub_date": "2021-09-17 15:59:00"
            },
            "creation_date": "2021-09-17 12:59:00"
        }
    ]
}
```

## Получение списка справочников, актуальных на указанную дату.
### запрос
`
curl --location --request GET 'http://127.0.0.1:8000/api/v1/directories/?search=2021-09-20'
`

### ответ
```json
{
    "count": 6,
    "next": null,
    "previous": null,
    "results": [
        {
            "uid": "1.2.643.5.1.13.13.99.2.863",
            "name": "ВМП. Справочник соответствия форм оплаты и источников оплаты",
            "title": "ВМП. Справочник соответствия форм оплаты и источников оплаты",
            "current_version": {
                "name": "1.1",
                "pub_date": "2021-09-22 09:35:00"
            },
            "creation_date": "2021-09-22 06:35:00"
        },
        {
            "uid": "1.2.643.5.1.13.13.99.2.747",
            "name": "РВ. Вакцины от коронавирусной инфекции (англоязычный)",
            "title": "РВ. Вакцины от коронавирусной инфекции (англоязычный)",
            "current_version": {
                "name": "1.6",
                "pub_date": "2021-09-21 11:16:00"
            },
            "creation_date": "2021-03-30 07:40:00"
        },
        {
            "uid": "1.2.643.5.1.13.13.99.2.611",
            "name": "Узлы СМНН. ЕСКЛП",
            "title": "Узлы СМНН. ЕСКЛП",
            "current_version": {
                "name": "4.21",
                "pub_date": "2021-09-22 14:46:00"
            },
            "creation_date": "2021-08-19 09:31:00"
        },
        {
            "uid": "1.2.643.5.1.13.13.99.2.308",
            "name": "Реестр ПВП (ФОМС)",
            "title": "Реестр ПВП (ФОМС)",
            "current_version": {
                "name": "2.305",
                "pub_date": "2021-09-23 20:00:00"
            },
            "creation_date": "2021-08-27 17:00:00"
        },
        {
            "uid": "1.2.643.5.1.13.13.99.2.166",
            "name": "Справочник кодируемых полей",
            "title": "Справочник кодируемых полей",
            "current_version": {
                "name": "1.66",
                "pub_date": "2021-09-22 12:25:00"
            },
            "creation_date": "2021-09-22 09:25:00"
        },
        {
            "uid": "1.2.643.5.1.13.13.99.2.114",
            "name": "ФРМО. Справочник структурных подразделений",
            "title": "ФРМО. Справочник структурных подразделений",
            "current_version": {
                "name": "2.869",
                "pub_date": "2021-09-24 02:41:00"
            },
            "creation_date": "2021-09-23 23:41:00"
        }
    ]
}
```

## Получение элементов заданного справочника текущей версии.
### запрос (успешный)
`
curl --location --request GET 'http://127.0.0.1:8000/api/v1/1.2.643.5.1.13.13.99.2.747/'
`
### ответ (успешный)
```json
{
    "count": 4,
    "next": null,
    "previous": null,
    "results": [
        {
            "id": 1,
            "uid": "1 (1)",
            "code": "1 (1)",
            "value": "Гам-КОВИД-Вак Комбинированная векторная вакцина для профилактики коронавирусной инфекции, вызываемой вирусом SARS-CoV-2"
        },
        {
            "id": 2,
            "uid": "3 (3)",
            "code": "3 (3)",
            "value": "ЭпиВакКорона Вакцина на основе пептидных антигенов для профилактики COVID-19"
        },
        {
            "id": 3,
            "uid": "4 (4)",
            "code": "4 (4)",
            "value": "КовиВак (Вакцина коронавирусная инактивированная цельновирионная концентрированная очищенная)"
        },
        {
            "id": 4,
            "uid": "5 (5)",
            "code": "5 (5)",
            "value": "Спутник Лайт Векторная вакцина для профилактики коронавирусной инфекции, вызываемой вирусом SARS-CoV-2"
        }
    ]
}
```
### запрос (ошибка)
`
curl --location --request GET 'http://127.0.0.1:8000/api/v1/1.2.643.5.1.13.13.99.2.7667/'
`
### ответ (ошибка)
```json
[
    "Такого UID справочника не существует!"
]
```

## Валидация элемента заданного справочника текущей версии.
### запрос (успешный)
`
curl --location --request POST 'http://127.0.0.1:8000/api/v1/1.2.643.5.1.13.13.99.2.747/3 (3)/'
`
### ответ (успешный)
```json
{
    "result": true
}
```
### запрос (неуспешный)
`
curl --location --request POST 'http://127.0.0.1:8000/api/v1/1.2.643.5.1.13.13.99.2.747/333 (3)/'
`
### ответ (неуспешный)
```json
{
    "result": false
}
```

## Получение элементов заданного справочника указанной версии.
### запрос (успешный)
`
curl --location --request GET 'http://127.0.0.1:8000/api/v1/1.2.643.5.1.13.13.99.2.747/version/1.3/'
`
### ответ (успешный)
```json
{
    "count": 3,
    "next": null,
    "previous": null,
    "results": [
        {
            "id": 1,
            "uid": "1 (1)",
            "code": "1 (1)",
            "value": "Гам-КОВИД-Вак Комбинированная векторная вакцина для профилактики коронавирусной инфекции, вызываемой вирусом SARS-CoV-2"
        },
        {
            "id": 2,
            "uid": "3 (3)",
            "code": "3 (3)",
            "value": "ЭпиВакКорона Вакцина на основе пептидных антигенов для профилактики COVID-19"
        },
        {
            "id": 3,
            "uid": "4 (4)",
            "code": "4 (4)",
            "value": "КовиВак (Вакцина коронавирусная инактивированная цельновирионная концентрированная очищенная)"
        }
    ]
}
```
### запрос (ошибка)
`
curl --location --request GET 'http://127.0.0.1:8000/api/v1/1.2.643.5.1.13.13.99.2.747/version/1.33/'
`
### ответ (ошибка)
```json
[
    "Такой версии справочника не существует или отсутствуют элементы справочника!"
]
```

## Валидация элемента заданного справочника по указанной версии.
### запрос (успешный)
`
curl --location --request POST 'http://127.0.0.1:8000/api/v1/1.2.643.5.1.13.13.99.2.747/version/1.3/3 (3)/'
`
### ответ (успешный)
```json
{
    "result": true
}
```
### запрос (неуспешный)
`
curl --location --request POST 'http://127.0.0.1:8000/api/v1/1.2.643.5.1.13.13.99.2.747/version/1.3/333 (3)/'
`
### ответ (неуспешный)
```json
{
    "result": false
}
```
